<ion-view view-title="{{journal}}">
    <ion-nav-buttons side="secondary">
        <a class="button button-icon icon ion-ios7-home-outline"
            href="#/app/journal/{{journal}}">
        </a>
    </ion-nav-buttons>
    <ion-content ng-controller="EditCommentController">
        <div class="blg-card card">
            <div class="blg-item item-button-left item item-divider">

                <button class="button button-light blg-avatar-button" ng-click="loadJournal(post.poster)">
                    <div class="blg-avatar-cropper">
                        <div class="blg-avatar-rounded"
                            style = 'background-image: url({{post.$$userpic ? post.$$userpic : defaultAvatar}})'>
                        </div>
                    </div>
                </button>

                <h2>{{post.$$subject}}</h2>
                <p class="blg-right">{{post.eventtime | dateFormat}}</p>
                <p>{{post.poster}}</p>
            </div>
            <div class="item item-text-wrap">
                <pre class="blg-html"
                    ng-bind-html="post.$$event"
                    ng-click="processLink($event)">
                </pre>
            </div>

            <ion-item ng-if="post.props && post.props.taglist" class="item-icon-left">
                <i class="icon ion-ios7-pricetags-outline placeholder-icon"></i>
                <span>{{post.props.$$taglist}}</span>
            </ion-item>

            <ion-item ng-if="post.props && post.props.current_location" class="item-icon-left">
                <i class="icon ion-ios7-location-outline placeholder-icon"></i>
                <span>{{post.props.current_location}}</span>
            </ion-item>

            <ion-item ng-if="post.props && post.props.current_mood" class="item-icon-left">
                <i class="icon ion-happy placeholder-icon"></i>
                <span>{{post.props.current_mood}}</span>
            </ion-item>

        </div>

        <div class="button-bar padding" style="padding-top: 0; padding-bottom: 0">
            <a
                class="blg-post-button button icon-left ion-ios7-chatboxes-outline"
                ng-class="{disabled: !(post.reply_count && !show.comments)}"
                ng-click="show.comments = true; getComments();">
                Show comments
            </a>
            <a
                class="blg-post-button button icon-left ion-ios7-trash-outline"
                ng-class="{disabled: !canDeleteEntry()}"
                ng-click="deleteEntry()">
                Delete entry
            </a>
            <a
                class="button icon-left ion-ios7-compose-outline"
                ng-class="{disabled: !canPostComment()}"
                ng-click="openCommentEdit(journal,post.ditemid,null)">
                Post comment
            </a>
        </div>

        <div ng-if="show.comments" class="list list-inset">
            <ion-list>
                <ng-include ng-if="child.children"
                    src="'app/post/comment.html'">
                </ng-include>
            </ion-list>
        </div>

        <div class="spinner spinner-post ng-hide"
            ng-show="loading.post"
            ng-style="{'top':getPostSpinnerHeight()+'px'}">
            <i class="icon ion-loading-d positive"></i>
        </div>

        <div class="spinner spinner-comments ng-hide"
            ng-show="loading.comments">
            <i class="icon ion-loading-d royal"></i>
        </div>

    </ion-content>
</ion-view>
